{% extends "SuperAdmin/dashbordSuperAdmin.html" %}
{% load static %}

{% block content %}
<div class="container py-5">
    <div class="d-flex justify-content-between align-items-center mb-5">
        <h2 class="fw-bold text-dark mb-0">
            <i class="bi bi-globe me-2 text-primary"></i> Website Management
        </h2>
        <a href="" class="btn btn-success shadow-sm d-flex align-items-center gap-2 px-4 py-2 rounded-pill">
            <i class="bi bi-plus-lg"></i> Add New Site
        </a>
    </div>

    <div class="card p-3 mb-4 shadow-sm border-0 rounded-3">
        <form method="get">
            <div class="row g-2 align-items-center">
                <div class="col-md">
                    <label for="status-select" class="form-label visually-hidden">Status</label>
                    <select name="status" class="form-select form-select-sm" id="status-select">
                        <option value="">Status: All</option>
                        <option value="Active" {% if status == 'Active' %}selected{% endif %}>✅ Active</option>
                        <option value="No Active" {% if status == 'No Active' %}selected{% endif %}>❌ Not Active</option>
                    </select>
                </div>
                <div class="col-md">
                    <label for="category-select" class="form-label visually-hidden">Category</label>
                    <select name="catégorie" class="form-select form-select-sm" id="category-select">
                        <option value="">Category: All</option>
                        {% for cat in catégories_list %}
                            <option value="{{ cat }}" {% if catégorie == cat %}selected{% endif %}>{{ cat }}</option>
                        {% endfor %}
                    </select>
                </div>
                <div class="col-md">
                    <label for="cms-select" class="form-label visually-hidden">CMS</label><br>
                    <select name="CMS" class="form-select form-select-sm" id="cms-select">
                        <option value="">CMS: All</option>
                        {% for c in cms_list %}
                            <option value="{{ c }}" {% if CMS == c %}selected{% endif %}>{{ c }}</option>
                        {% endfor %}
                    </select>
                </div>
                <div class="col-md">
                    <label for="language-select" class="form-label visually-hidden">Language</label>
                    <select name="langues" class="form-select form-select-sm" id="language-select">
                        <option value="">Language: All</option>
                        {% for l in langues_list %}
                            <option value="{{ l }}" {% if langues == l %}selected{% endif %}>{{ l }}</option>
                        {% endfor %}
                    </select>
                </div>
                <div class="col-md">
                    <label for="plan-select" class="form-label visually-hidden">Plan</label><br>
                    <select name="plan" class="form-select form-select-sm" id="plan-select">
                        <option value="">Plan: All</option>
                        {% for p in plans_list %}
                            <option value="{{ p }}" {% if plan == p %}selected{% endif %}>{{ p }}</option>
                        {% endfor %}
                    </select>
                </div>
                <div class="col-md-auto d-flex gap-2">
                    <button type="submit" class="btn btn-dark btn-sm flex-grow-1">
                        <i class="bi bi-search me-1"></i> Filter
                    </button>&nbsp;
                    <a href="{% url 'websites_list_superadmin' %}" class="btn btn-outline-secondary btn-sm flex-grow-1">
                        <i class="bi bi-arrow-clockwise me-1"></i> Reset
                    </a>
                </div>
            </div>
        </form>
    </div>

    <div class="row row-cols-1 row-cols-sm-2 row-cols-lg-3 row-cols-xl-4 g-4">
        {% for website in websites %}
        <div class="col">
            <div class="card h-100 shadow-sm border-0 rounded-4 website-card-hover">
                <div class="position-relative">
                    <img src="{% static 'img/css-image-gallery.jpg' %}" class="card-img-top rounded-top-4" alt="{{ website.name }} Website" style="height: 180px; object-fit: cover;">
                    {% comment %} <span class="badge position-absolute top-0 end-0 m-3 {% if website.status == 'Active' %}bg-success{% else %}bg-danger{% endif %} py-2 px-3 rounded-pill">{{ website.status }}</span> {% endcomment %}
                </div>
                <div class="card-body d-flex flex-column">
                    <h5 class="card-title text-truncate fw-bold mb-1 text-dark">{{ website.name }}</h5>
                    <p class="card-text text-muted small mb-3">
                        <i class="bi bi-tag me-1"></i> {{ website.catégorie }}
                    </p>
                    <ul class="list-unstyled small text-muted mb-3 flex-grow-1">
                        <li class="d-flex align-items-center gap-2 mb-1">
                            <i class="bi bi-cash-coin text-info"></i> <strong>Price:</strong> {{ website.prix }} MAD
                        </li>
                        <li class="d-flex align-items-center gap-2 mb-1">
                            <i class="bi bi-puzzle-fill text-info"></i> <strong>CMS:</strong> {{ website.CMS }}
                        </li>
                        <li class="d-flex align-items-center gap-2 mb-1">
                            <i class="bi bi-translate text-info"></i> <strong>Language:</strong> {{ website.langues }}
                        </li>
                        <li class="d-flex align-items-center gap-2">
                            <i class="bi bi-journal-check text-info"></i> <strong>Plan:</strong> {{ website.plan }}
                        </li><br>
                        <li class="d-flex align-items-center gap-2 mb-1">
                          <i class="bi bi-translate text-info"></i> <strong>Status:</strong>  <span style="color: white;" class="badge position-absolute top-0 end-0 m-3 {% if website.status == 'Active' %}bg-success{% else %}bg-danger{% endif %} py-2 px-3 rounded-pill">{{ website.status }}</span>
                      </li>
                    </ul>
                    <div class="d-grid gap-2 d-md-flex mt-auto">
                        {% comment %} <a href="{% url 'view_website_detail' website.id %}" class="btn btn-outline-primary btn-sm flex-grow-1">
                            <i class="bi bi-eye me-1"></i> View
                        </a>
                        <a href="{% url 'edit_website' website.id %}" class="btn btn-outline-warning btn-sm flex-grow-1">
                            <i class="bi bi-pencil me-1"></i> Edit
                        </a>
                        <a href="{% url 'delete_website' website.id %}" class="btn btn-outline-danger btn-sm flex-grow-1" onclick="return confirm('Are you sure you want to delete {{ website.name }}?')">
                            <i class="bi bi-trash me-1"></i> Delete
                        </a>
                    </div> {% endcomment %}
                </div>
            </div>
        </div>
        {% empty %}
        <div class="col-12">
            <div class="alert alert-info text-center py-4 rounded-3 shadow-sm">
                <i class="bi bi-info-circle-fill me-2"></i> No websites found matching your criteria.
            </div>
        </div>
        {% endfor %}
    </div>
</div>

<style>
  /* Google Fonts - Inter for clean typography */
  @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');

  :root {
      --primary-brand-color: #007bff; /* A nice, vibrant blue for brand elements */
      --success-color: #28a745;
      --danger-color: #dc3545;
      --warning-color: #ffc107;
      --info-color: #17a2b8;
      --dark-text: #343a40; /* Darker text for better readability */
      --muted-text: #6c757d;
      --light-bg: #f8f9fa;
      --card-bg: #ffffff;
      --border-color: #dee2e6;
      --shadow-light: rgba(0, 0, 0, 0.05);
      --shadow-medium: rgba(0, 0, 0, 0.1);
  }

  body {
      font-family: 'Inter', sans-serif;
      background-color: var(--light-bg); /* Light background for the overall page */
      color: var(--dark-text);
  }

  /* Header Styling */
  h2 {
      color: var(--dark-text);
      font-weight: 700;
  }

  .btn-success {
      background-color: var(--success-color);
      border-color: var(--success-color);
      transition: all 0.2s ease-in-out;
  }
  .btn-success:hover {
      background-color: #218838;
      border-color: #1e7e34;
      transform: translateY(-1px);
      box-shadow: 0 4px 8px var(--shadow-medium);
  }
  .btn-success:active {
      transform: translateY(0);
      box-shadow: none;
  }

  /* Filter Card */
  .card.p-3 {
      background-color: var(--card-bg);
      border: 1px solid var(--border-color);
      box-shadow: 0 0.125rem 0.25rem var(--shadow-light);
  }

  .form-select-sm, .form-control-sm {
      height: calc(1.8125rem + 2px); /* Smaller height for compact filters */
      padding: 0.25rem 0.5rem;
      font-size: 0.875rem;
      border-radius: 0.375rem; /* Slightly rounded */
      border-color: var(--border-color);
      transition: border-color 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
  }
  .form-select-sm:focus, .form-control-sm:focus {
      border-color: var(--primary-brand-color);
      box-shadow: 0 0 0 0.2rem rgba(0, 123, 255, 0.25);
  }
  
  .btn-dark {
      background-color: var(--dark-text);
      border-color: var(--dark-text);
      color: white;
  }
  .btn-dark:hover {
      background-color: #495057;
      border-color: #495057;
  }

  /* Website Cards */
  .website-card-hover {
      border: 1px solid var(--border-color);
      transition: transform 0.3s ease-in-out, box-shadow 0.3s ease-in-out, border-color 0.3s ease-in-out;
  }
  .website-card-hover:hover {
      transform: translateY(-5px);
      box-shadow: 0 1rem 2rem var(--shadow-medium) !important; /* More pronounced shadow on hover */
      border-color: var(--primary-brand-color); /* Highlight border on hover */
  }

  .card-img-top {
      border-top-left-radius: calc(1rem - 1px); /* Match card rounded corners */
      border-top-right-radius: calc(1rem - 1px);
  }

  .card-title {
      font-size: 1.15rem;
      font-weight: 600;
      color: var(--dark-text);
  }

  .card-body .list-unstyled li {
      font-size: 0.9rem;
      color: var(--muted-text);
  }
  .card-body .list-unstyled li strong {
      color: var(--dark-text);
      font-weight: 500;
  }
  .card-body .list-unstyled li i {
      color: var(--info-color); /* A subtle color for information icons */
      font-size: 0.95rem;
      min-width: 1.25rem; /* Align icons */
  }

  .badge {
      font-size: 0.75rem;
      font-weight: 700;
  }
  .badge.bg-success {
      background-color: var(--success-color) !important;
  }
  .badge.bg-danger {
      background-color: var(--danger-color) !important;
  }

  /* Action Buttons within cards */
  .card-body .btn-sm {
      font-size: 0.8rem;
      padding: 0.4rem 0.75rem;
      border-radius: 0.3rem;
      transition: all 0.2s ease-in-out;
  }
  .card-body .btn-outline-primary {
      color: var(--primary-brand-color);
      border-color: var(--primary-brand-color);
  }
  .card-body .btn-outline-primary:hover {
      background-color: var(--primary-brand-color);
      color: white;
  }
  .card-body .btn-outline-warning {
      color: var(--warning-color);
      border-color: var(--warning-color);
  }
  .card-body .btn-outline-warning:hover {
      background-color: var(--warning-color);
      color: white;
  }
  .card-body .btn-outline-danger {
      color: var(--danger-color);
      border-color: var(--danger-color);
  }
  .card-body .btn-outline-danger:hover {
      background-color: var(--danger-color);
      color: white;
  }
  .card-body .btn-outline-secondary { /* For view button if you want it different */
      color: var(--muted-text);
      border-color: var(--muted-text);
  }
  .card-body .btn-outline-secondary:hover {
      background-color: var(--muted-text);
      color: white;
  }
</style>
{% endblock %}