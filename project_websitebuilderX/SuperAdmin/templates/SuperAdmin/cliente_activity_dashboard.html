{% extends "SuperAdmin/dashbordSuperAdmin.html" %}
{% load static %}

{% block content %}

<div class="main-content app-content">
  <div class="container-fluid">

    <!-- PAGE-HEADER -->
    <div class="page-header">
      <h1 class="page-title my-auto">üìä Activit√©s du client ‚Äì {{ cliente.user.username }}</h1>
      <div>
        <ol class="breadcrumb mb-0">
          <li class="breadcrumb-item">
            <a href="{% url 'ClienteSuperAdmin' %}">Clients</a>
          </li>
          <li class="breadcrumb-item active" aria-current="page">Activit√©s</li>
        </ol>
      </div>
    </div>

    <!-- R√©sum√© badges -->
    <div class="mb-4">
      <span class="badge bg-info me-2">Recharges : {{ demandes|length }}</span>
      <span class="badge bg-success me-2">Achats : {{ achats|length }}</span>
      <span class="badge bg-primary me-2">Tickets : {{ tickets|length }}</span>
      <span class="badge bg-secondary me-2">Supports : {{ achat_supports|length }}</span>
      <span class="badge bg-dark me-2">Locations : {{ locations|length }}</span>
      <span class="badge bg-warning me-2">Demandes support : {{ supports|length }}</span>
      <span class="badge bg-info">Sites gratuits : {{ free_websites|length }}</span>
    </div>

    <!-- ROW -->
    <div class="row">
      <div class="col-12 col-sm-12">

        <!-- üí∞ Demandes de recharge -->
        <div class="card mb-4">
          <div class="card-header bg-info text-black">üí∞ Demandes de recharge</div>
          <div class="card-body product-table">
            <div class="table-responsive">
              <table class="table table-bordered text-nowrap mb-0">
                <thead class="border-top">
                  <tr><th>Code</th><th>Montant</th><th>Statut</th><th>Date</th></tr>
                </thead>
                <tbody>
                  {% for d in demandes %}
                  <tr>
                    <td>{{ d.code_DemandeRecharger }}</td>
                    <td>{{ d.solde }} MAD</td>
                    <td>{{ d.status }}</td>
                    <td>{{ d.date_created|date:"d/m/Y H:i" }}</td>
                  </tr>
                  {% empty %}
                  <tr>
                    <td colspan="4">
                      <div class="empty-state text-center">
                        <i class="fas fa-box-open fa-2x text-muted"></i>
                        <p class="mt-2">Aucune demande enregistr√©e.</p>
                      </div>
                    </td>
                  </tr>
                  {% endfor %}
                </tbody>
              </table>
            </div>
          </div>
        </div>

        <!-- üåê Sites achet√©s -->
        <div class="card mb-4">
          <div class="card-header bg-success text-black">üåê Sites achet√©s</div>
          <div class="card-body product-table">
            <div class="table-responsive">
              <table class="table table-bordered text-nowrap mb-0">
                <thead>
                  <tr><th>Nom</th><th>Prix</th><th>Statut</th><th>Date</th></tr>
                </thead>
                <tbody>
                  {% for a in achats %}
                  <tr>
                    <td>{{ a.websites.name }}</td>
                    <td>{{ a.prix_achat }} MAD</td>
                    <td>{{ a.BuilderStatus }}</td>
                    <td>{{ a.date_created|date:"d/m/Y H:i" }}</td>
                  </tr>
                  {% empty %}
                  <tr>
                    <td colspan="4" class="text-center text-muted">Aucun site achet√©.</td>
                  </tr>
                  {% endfor %}
                </tbody>
              </table>
            </div>
          </div>
        </div>

        <!-- üé´ Tickets -->
        <div class="card mb-4">
          <div class="card-header bg-primary text-black">üé´ Tickets</div>
          <div class="card-body product-table">
            <div class="table-responsive">
              <table class="table table-bordered text-nowrap mb-0">
                <thead>
                  <tr><th>Sujet</th><th>Statut</th><th>Date</th></tr>
                </thead>
                <tbody>
                  {% for t in tickets %}
                  <tr>
                    <td>{{ t.description }}</td>
                    <td>{{ t.status }}</td>
                    <td>{{ t.date_created|date:"d/m/Y H:i" }}</td>
                  </tr>
                  {% empty %}
                  <tr>
                    <td colspan="3" class="text-center text-muted">Aucun ticket.</td>
                  </tr>
                  {% endfor %}
                </tbody>
              </table>
            </div>
          </div>
        </div>

         <!-- üé´ Supports achet√©s -->
         <div class="card mb-4">
          <div class="card-header bg-primary text-black">üßæ Supports achet√©s</div>
          <div class="card-body product-table">
            <div class="table-responsive">
              <table class="table table-bordered text-nowrap mb-0">
                <thead>
                  <tr><th>Support</th><th>Prix</th><th>Consommation</th><th>Technicien</th><th>Date</th></tr>
                </thead>
                <tbody>
                  {% for s in achat_supports %}
                  <tr>
                    <td>{{ s.support.name }}</td>
                    <td>{{ s.prix }}</td>
                    <td>{{ s.Status }}</td>
                    <td>{{ s.StatusConsom√© }}</td>
                    <td>
                      {% if s.updated_by %}
                        {{ s.updated_by.user.username }}
                      {% else %}
                        <span class="text-muted">Non assign√©</span>
                      {% endif %}
                    </td>
                    <td>{{ s.date_created|date:"d/m/Y H:i" }}</td>
                  </tr>
                  {% empty %}
                  <tr>
                    <td colspan="3" class="text-center text-muted">Aucun support achet√©.</td>
                  </tr>
                  {% endfor %}
                </tbody>
              </table>
            </div>
          </div>
        </div>


         <!-- üè† Locations de sites web  -->
         <div class="card mb-4">
          <div class="card-header bg-primary text-black">üè† Locations de sites web </div>
          <div class="card-body product-table">
            <div class="table-responsive">
              <table class="table table-bordered text-nowrap mb-0">
                <thead>
                  <tr><th>Site Web</th><th>Prix du loyer</th><th>Statut du builder</th><th>Date d√©bu</th><th>Date fin</th><th>Date de cr√©ation</th></tr>
                </thead>
                <tbody>
                  {% for l in locations %}
                  <tr>
                    <td>{{ l.websites.name }}</td>
                    <td>{{ l.prix_loyer }} MAD</td>
                    <td>{{ l.BuilderStatus }}</td>
                    <td>{{ l.date_debut|date:"d/m/Y H:i" }}</td>
                    <td>
                      {% if l.date_fin %}
                        {{ l.date_fin|date:"d/m/Y H:i" }}
                      {% else %}
                        <span class="text-muted">Non d√©finie</span>
                      {% endif %}
                    </td>
                    <td>{{ l.date_created|date:"d/m/Y H:i" }}</td>
                  </tr>
                  {% empty %}
                  <tr>
                    <td colspan="3" class="text-center text-muted">Aucun location enregistr√©e.</td>
                  </tr>
                  {% endfor %}
                </tbody>
              </table>
            </div>
          </div>
        </div>

        
         <!-- üÜì Sites web gratuits  -->
         <div class="card mb-4">
          <div class="card-header bg-primary text-black">üÜì Sites web gratuits </div>
          <div class="card-body product-table">
            <div class="table-responsive">
              <table class="table table-bordered text-nowrap mb-0">
                <thead>
                  <tr><th>Site Web</th><th>Prix (gratuit)</th><th>Statut du builder</th><th>Date de cr√©ation</th></tr>
                </thead>
                <tbody>
                  {% for f in free_websites %}
                  <tr>
                    <td>{{ f.websites.name }}</td>
                    <td>{{ f.prix_free }} MAD</td>
                    <td>{{ f.BuilderStatus }}</td>
                    <td>{{ f.date_created|date:"d/m/Y H:i" }}</td>
                  </tr>
                  {% empty %}
                  <tr>
                    <td colspan="3" class="text-center text-muted">Aucun site gratuit attribu√©.</td>
                  </tr>
                  {% endfor %}
                </tbody>
              </table>
            </div>
          </div>
        </div>


          <!-- üõ† Demandes de support technique  -->
          <div class="card mb-4">
            <div class="card-header bg-primary text-black">üõ† Demandes de support technique </div>
            <div class="card-body product-table">
              <div class="table-responsive">
                <table class="table table-bordered text-nowrap mb-0">
                  <thead>
                    <tr><th>Code</th><th>Support demand√©</th><th>Statut</th><th>Technicien</th><th>Date</th></tr>
                  </thead>
                  <tbody>
                    {% for s in supports %}
                    <tr>
                      <td>{{ s.code_DemandeSupport }}</td>
                      <td>{{ s.achat_support.support.name }}</td>
                      <td>{{ s.status }}</td>
                      <td>
                        {% if s.updated_by %}
                          {{ s.updated_by.user.username }}
                        {% else %}
                          <span class="text-muted">Non assign√©</span>
                        {% endif %}
                      </td>
                      <td>{{ s.date_created|date:"d/m/Y H:i" }}</td>
                    </tr>
                    {% empty %}
                    <tr>
                      <td colspan="3" class="text-center text-muted">Aucun demande de support enregistr√©e.</td>
                    </tr>
                    {% endfor %}
                  </tbody>
                </table>
              </div>
            </div>
          </div>


      </div>
    </div>
  </div>
</div>

{% endblock %}
